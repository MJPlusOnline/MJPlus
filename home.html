<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/png" href="favicon.png">
  <title>MJ+ – Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1"></script>
  <link rel="stylesheet" href="mobile.css?v=2" media="(max-width: 768px)">

  <style>
  /* --- Animated Logo Glow (deins bleibt) --- */
  @keyframes imgGlow {
    0%, 100% {
      filter: drop-shadow(0 0 6px rgba(255,255,255,0.6))
              drop-shadow(0 0 12px rgba(255,255,255,0.3));
    }
    50% {
      filter: drop-shadow(0 0 16px rgba(255,255,255,0.9))
              drop-shadow(0 0 30px rgba(255,255,255,0.6));
    }
  }
  header .logo { animation: imgGlow 3.5s ease-in-out infinite; transition: filter 0.3s ease; }

  :root{
    --accent:#e50914; --spaceX:clamp(14px,3vw,44px); --spaceY:clamp(12px,2.2vw,28px);
    --logoH:clamp(70px,9vh,110px); --navFS:clamp(11px,.95vw,15px); --h2FS:clamp(16px,1.2vw,20px);
    --tileW:clamp(120px,10vw,170px); --gap:clamp(10px,1.2vw,16px); --progressH:3px;
  }
  *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
  html,body{height:100%}
  body{margin:0;background:#000;color:#fff;font:clamp(13px,1vw,16px)/1.45 system-ui,-apple-system,Segoe UI,Roboto,sans-serif;overflow-x:hidden}
  a{color:inherit;text-decoration:none} :focus,:focus-visible{outline:0}
  header{
    position:sticky;top:0;z-index:20;display:flex;align-items:center;justify-content:space-between;
    padding:10px var(--spaceX);background:#000d;border-bottom:1px solid #ffffff14;backdrop-filter:saturate(1.15) blur(4px)
  }
  .logo{height:var(--logoH);display:block}
  nav{display:flex;gap:clamp(8px,.8vw,12px);align-items:center;white-space:nowrap}
  nav a, .nav-btn{
    color:#fff;font-size:var(--navFS);text-transform:uppercase;font-weight:800;letter-spacing:.04em;
    padding:4px 8px;border-radius:6px;transition:transform .16s,color .16s,text-shadow .16s;background:none;border:0;cursor:pointer
  }
  nav a:hover,nav a:focus-visible,.nav-btn:hover,.nav-btn:focus-visible{transform:scale(1.06);color:var(--accent);text-shadow:0 0 10px rgba(229,9,20,.55)}
  nav a.active{color:var(--accent);text-shadow:0 0 10px rgba(229,9,20,.55)}
  /* Make SEARCH stand out */
  #openSearch{background:var(--accent);border:1px solid var(--accent);color:#fff;padding:6px 12px;border-radius:10px}
  #openSearch:hover,#openSearch:focus-visible{transform:scale(1.06);filter:brightness(1.08)}

  .menu-spacer{height:8px}
  .section{padding:var(--spaceY) var(--spaceX)}
  .section h2{font-size:var(--h2FS);margin:0 0 10px 6px}

  /* Continue Watching Row */
  .continue-row{display:flex;gap:var(--gap);overflow-x:auto;padding:8px;scrollbar-width:none}
  .continue-row::-webkit-scrollbar{display:none}
  .continue-row .tile{flex:0 0 var(--tileW);}

  /* Continue Watching – Carousel Arrows */
.cw-wrap{ position:relative; }
.cw-wrap .continue-row{ scroll-behavior:smooth; }

.cw-arrow{
  position:absolute; top:50%; transform:translateY(-50%);
  width:40px; height:56px;
  display:flex; align-items:center; justify-content:center;
  background:rgba(0,0,0,.4);              /* etwas transparenter */
  border:1px solid rgba(255,255,255,.18); /* weniger sichtbar */
  border-radius:12px;
  color:#fff; font-size:28px; line-height:1; font-weight:900;
  cursor:pointer; z-index:10;
  backdrop-filter:saturate(1.2) blur(2px);
  box-shadow:0 4px 20px rgba(0,0,0,.25);
  transition:opacity .18s, transform .18s, background .18s, border-color .18s;
  opacity:0;
}
.cw-arrow:not([hidden]){ opacity:.6; } /* leicht sichtbar selbst ohne Hover */
.cw-wrap:hover .cw-arrow{ opacity:1; } /* beim Hover klarer sichtbar */

#cwLeft{ left:-32px; }   /* weiter außen positioniert */
#cwRight{ right:-32px; } /* weiter außen positioniert */

.cw-arrow:hover,
.cw-arrow:focus-visible{
  transform:translateY(-50%) scale(1.07);
  background:rgba(0,0,0,.6);
  border-color:rgba(255,255,255,.25);
}

  /* Tiles + Grid (ALL) */
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(var(--tileW),1fr));gap:var(--gap)}
  .tile{position:relative;cursor:pointer;background:none;border:0;padding:0;transition:transform .18s ease;width:var(--tileW)}
  .tile img{width:100%;aspect-ratio:2/3;object-fit:cover;border-radius:12px;display:block;box-shadow:0 2px 6px #000a}
  .tile::after{
    content:"";position:absolute;inset:-10px;border-radius:14px;
    background:radial-gradient(ellipse at center, rgba(229,9,20,.35) 0%, rgba(229,9,20,.18) 36%, transparent 70%);
    filter:blur(14px);opacity:0;transition:opacity .18s
  }
  .tile:hover,.tile:focus-visible{transform:scale(1.06)}
  .tile:hover::after,.tile:focus-visible::after{opacity:1}
  .badge{
    position:absolute;top:6px;right:6px;font-weight:900;font-size:11px;letter-spacing:.06em;
    padding:4px 6px;border-radius:8px;background:#e50914;color:#fff;box-shadow:0 2px 10px #000c
  }
  .progress-wrap{
    position:absolute;left:0;right:0;bottom:0;height:var(--progressH);border-radius:0 0 12px 12px;
    background:rgba(255,255,255,.08);overflow:hidden;pointer-events:none
  }
  .progress{height:100%;background:var(--accent);width:0%}

  /* Search overlay (unverändert) */
  #searchModal{position:fixed;inset:0;display:none;z-index:120;align-items:center;justify-content:center;background:rgba(0,0,0,.7)}
  .search-card{width:min(95vw,980px);max-height:85vh;background:#111;border-radius:14px;box-shadow:0 10px 40px #000c;display:flex;flex-direction:column;overflow:hidden}
  .search-head{display:flex;gap:10px;align-items:center;padding:12px;border-bottom:1px solid #ffffff14}
  .search-field{position:relative;flex:1;display:flex}
  .search-input{flex:1;background:#000;border:1px solid #ffffff33;border-radius:10px;color:#fff;padding:10px 40px 10px 12px;font-weight:700;letter-spacing:.02em}
  .search-x{position:absolute;right:8px;top:50%;transform:translateY(-50%);background:#000;border:1px solid #ffffff33;border-radius:50%;width:28px;height:28px;color:#fff;font-weight:900;cursor:pointer}
  .search-btn{background:#e50914;border:0;color:#fff;padding:10px 14px;border-radius:10px;font-weight:800;letter-spacing:.04em;cursor:pointer}
  .search-body{padding:12px;overflow:auto}
  .search-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(var(--tileW),1fr));gap:var(--gap)}

  /* Mobile Header + Dropdown-Navigation */
  @media (max-width: 768px){
    header{position: sticky; top:0; z-index:20; display:flex; flex-direction:column; align-items:center; gap:8px; padding:10px 16px;}
    header .logo{height:64px; margin:4px auto 0 auto; display:block;}
    .menu-toggle{
      display:block; background:#000; color:#fff; border:1px solid #ffffff33; border-radius:10px; padding:10px 14px;
      font-weight:800; letter-spacing:.04em; cursor:pointer; width:100%; max-width:520px; text-align:center;
    }
    header nav{
      width:100%; max-width:520px; margin:0 auto; display:block; overflow:hidden; max-height:0;
      transition:max-height .28s ease; border-radius:12px; border:1px solid #ffffff14; background:#000a;
    }
    header.nav-open nav{ max-height:60vh; }
    header nav a, header nav .nav-btn{
      display:block; width:100%; text-align:center; padding:12px 14px; border-bottom:1px solid #ffffff14;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    header nav a:last-child, header nav .nav-btn:last-child{ border-bottom:0; }
    html,body{ overflow-x:hidden; }
  }
  </style>
</head>

<body data-page="home">
  <!-- ONE-TIME NOTICE (unverändert) -->
  <div id="noticeOverlay" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.85); color:#fff;z-index:9999;align-items:center;justify-content:center;">
    <div style="max-width:600px;margin:16px;padding:24px;background:#111;border-radius:12px; box-shadow:0 6px 30px rgba(0,0,0,.6);text-align:left;line-height:1.5em;position:relative;">
      <h2 style="margin:0 0 12px;color:#e50914;">Important Notice</h2>
      <p style="margin:0 0 10px;">
        MJPlus is not affiliated with or endorsed by the Michael Jackson Estate. This website is a fan-driven passion
        project, created by fans, for fans, with no intention of financial gain.
      </p>
      <p style="margin:0 0 10px;">
        Our purpose is solely to preserve and share unofficial content, including concerts, television recordings,
        reports, documentaries, and other rare materials. We do not host or distribute any officially released content.
      </p>
      <button id="noticeClose" style="margin-top:14px;padding:8px 16px;background:#e50914;border:none;color:#fff;border-radius:6px; cursor:pointer;font-weight:bold;">Close</button>
    </div>
  </div>

  <script>
    (function () {
      try {
        const KEY = 'mjplus_notice_seen';
        const overlay = document.getElementById('noticeOverlay');
        const btn = document.getElementById('noticeClose');
        if (!localStorage.getItem(KEY)) {
          overlay.style.display = 'flex';
          btn.addEventListener('click', function () {
            overlay.style.display = 'none';
            localStorage.setItem(KEY, '1');
          });
        }
      } catch (e) { console.warn('notice overlay init failed', e); }
    })();
  </script>

  <!-- Header + Nav -->
  <header>
    <img src="logo.png" alt="MJ+ Logo" class="logo">
    <nav aria-label="Main menu">
      <a href="home.html" class="active" tabindex="0" data-nav>Home</a>
      <a href="live.html" tabindex="0" data-nav>Live</a>
      <a href="tv-appearances.html" tabindex="0" data-nav>TV Appearances</a>
      <a href="short-films.html" tabindex="0" data-nav>Short Films</a>
      <a href="jacksons.html" tabindex="0" data-nav>The Jacksons</a>
      <a href="feedback.html" tabindex="0" data-nav>Feedback</a>
    </nav>
  </header>
  <div class="menu-spacer"></div>

  <main id="appMain" aria-live="polite">
    <!-- Continue Watching (wird von player.js sichtbar gemacht) -->
    <section id="continueSec" class="section" style="display:none">
      <h2 id="h2Continue">Continue Watching</h2>
      <div class="cw-wrap">
        <button id="cwLeft" class="cw-arrow" aria-label="Scroll left" hidden>‹</button>
        <div id="continueRow" class="continue-row" tabindex="0"></div>
        <button id="cwRight" class="cw-arrow" aria-label="Scroll right" hidden>›</button>
      </div>
    </section>

    <!-- ALL Grid bleibt wie gehabt; wird von player.js befüllt -->
    <section class="section">
      <h2>All</h2>
      <div id="grid" class="grid"></div>
    </section>
  </main>

  <!-- JS -->
  <script src="catalog.js?v=1.0.3"></script>
  <script src="player.js?v=1.0.3"></script>
  <script src="mobile-menu.js?v=1.0.0"></script>
  <script src="playlist.js"></script>
  <script>
    window.MJPLUS?.initHome?.();
    window.MJPLUS?.initSearchUI?.();
  </script>

  <!-- Pfeil-Logik nur für Continue Watching -->
  <script>
  (function(){
    function setupCwArrows(){
      const row   = document.getElementById('continueRow');
      const left  = document.getElementById('cwLeft');
      const right = document.getElementById('cwRight');
      if (!row || !left || !right) return;

      function tileWidth(){
        const t = row.querySelector('.tile');
        return t ? t.getBoundingClientRect().width : row.clientWidth * 0.5;
      }
      function step(){
        const w = tileWidth();
        const perView = Math.max(1, Math.floor(row.clientWidth / w));
        return Math.max(w * perView, row.clientWidth * 0.6);
      }
      function update(){
        const canScroll = row.scrollWidth > row.clientWidth + 2;
        const atStart   = row.scrollLeft <= 4;
        const atEnd     = row.scrollLeft + row.clientWidth >= row.scrollWidth - 4;
        left.hidden  = !canScroll || atStart;
        right.hidden = !canScroll || atEnd;
      }

      left.addEventListener('click',  () => row.scrollBy({ left: -step(), behavior: 'smooth' }));
      right.addEventListener('click', () => row.scrollBy({ left:  step(), behavior: 'smooth' }));
      row.addEventListener('scroll', update);

      // Reagiert auf Größenänderung & wenn player.js neue Tiles rendert
      new ResizeObserver(update).observe(row);
      new MutationObserver(update).observe(row, { childList:true });

      // Tastatur ← / →
      row.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowLeft')  { e.preventDefault(); row.scrollBy({ left: -step(), behavior: 'smooth' }); }
        if (e.key === 'ArrowRight') { e.preventDefault(); row.scrollBy({ left:  step(), behavior: 'smooth' }); }
      });

      // initiales Update, nachdem initHome gelaufen ist
      setTimeout(update, 150);
    }

    // Nach dem Laden + nach kurzer Wartezeit (falls initHome async rendert)
    window.addEventListener('load', setupCwArrows);
    setTimeout(setupCwArrows, 400);
  })();
  </script>
</body>
</html>