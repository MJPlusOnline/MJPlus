<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/png" href="favicon.png">
  <title>MJ+ – Live</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1"></script>
  <style>
/* --- Animated Logo Glow --- */
@keyframes imgGlow {
  0%, 100% {
    filter: drop-shadow(0 0 6px rgba(255,255,255,0.6))
            drop-shadow(0 0 12px rgba(255,255,255,0.3));
  }
  50% {
    filter: drop-shadow(0 0 16px rgba(255,255,255,0.9))
            drop-shadow(0 0 30px rgba(255,255,255,0.6));
  }
}

header .logo {
  animation: imgGlow 3.5s ease-in-out infinite;
  transition: filter 0.3s ease;
}
    :root{
      --accent:#e50914; --spaceX:clamp(14px,3vw,44px); --spaceY:clamp(12px,2.2vw,28px);
      --logoH:clamp(70px,9vh,110px); --navFS:clamp(11px,.95vw,15px); --h2FS:clamp(16px,1.2vw,20px);
      --tileW:clamp(120px,10vw,170px); --gap:clamp(10px,1.2vw,16px);
    }
    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
    html,body{height:100%}
    body{margin:0;background:#000;color:#fff;font:clamp(13px,1vw,16px)/1.45 system-ui,-apple-system,Segoe UI,Roboto,sans-serif;overflow-x:hidden}
    a{color:inherit;text-decoration:none} :focus,:focus-visible{outline:0}
    header{position:sticky;top:0;z-index:20;display:flex;align-items:center;justify-content:space-between;
      padding:10px var(--spaceX);background:#000d;border-bottom:1px solid #ffffff14;backdrop-filter:saturate(1.15) blur(4px)}
    .logo{height:var(--logoH);display:block}
    nav{display:flex;gap:clamp(8px,.8vw,12px);align-items:center;white-space:nowrap}
    nav a, .nav-btn{color:#fff;font-size:var(--navFS);text-transform:uppercase;font-weight:800;letter-spacing:.04em;
      padding:4px 8px;border-radius:6px;transition:transform .16s,color .16s,text-shadow .16s;background:none;border:0;cursor:pointer}
    nav a:hover,nav a:focus-visible,.nav-btn:hover,.nav-btn:focus-visible{transform:scale(1.06);color:var(--accent);text-shadow:0 0 10px rgba(229,9,20,.55)}
    nav a.active{color:var(--accent);text-shadow:0 0 10px rgba(229,9,20,.55)}
    .menu-spacer{height:8px}

    /* Filterbar */
    .filters{display:flex;gap:8px;flex-wrap:wrap;padding:var(--spaceY) var(--spaceX) 8px}
    .filter-btn{background:#111;border:1px solid #ffffff2a;color:#fff;border-radius:999px;padding:8px 12px;font-weight:800;letter-spacing:.04em;cursor:pointer}
    .filter-btn.active{background:var(--accent);border-color:var(--accent)}

    .section{padding:10px var(--spaceX)}
    .section h2{font-size:var(--h2FS);margin:0 0 10px 6px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(var(--tileW),1fr));gap:var(--gap)}
    .tile{position:relative;cursor:pointer;background:none;border:0;padding:0;transition:transform .18s ease;width:var(--tileW)}
    .tile img{width:100%;aspect-ratio:2/3;object-fit:cover;border-radius:12px;display:block;box-shadow:0 2px 6px #000a}
    .tile::after{content:"";position:absolute;inset:-10px;border-radius:14px;
      background:radial-gradient(ellipse at center, rgba(229,9,20,.35) 0%, rgba(229,9,20,.18) 36%, transparent 70%);
      filter:blur(14px);opacity:0;transition:opacity .18s}
    .tile:hover,.tile:focus-visible{transform:scale(1.06)} .tile:hover::after,.tile:focus-visible::after{opacity:1}
    .badge{position:absolute;top:6px;right:6px;font-weight:900;font-size:11px;letter-spacing:.06em;
      padding:4px 6px;border-radius:8px;background:#e50914;color:#fff;box-shadow:0 2px 10px #000c}

    /* Tours Layout */
    #toursSec{display:none}
    .tour-block{padding:18px var(--spaceX) 8px}
    .tour-title{font-size:clamp(18px,1.4vw,22px);font-weight:900;letter-spacing:.02em;margin:0 0 12px}
/* Mobile Header + Dropdown-Navigation */
@media (max-width: 768px){
  header{
    position: sticky; top:0; z-index:20;
    display:flex; flex-direction:column; align-items:center; gap:8px;
    padding:10px 16px;
  }
  header .logo{
    height:64px; margin:4px auto 0 auto; display:block;
  }
  /* Toggle-Button unter dem Logo */
  .menu-toggle{
    display:block;
    background:#000; color:#fff; border:1px solid #ffffff33;
    border-radius:10px; padding:10px 14px; font-weight:800;
    letter-spacing:.04em; cursor:pointer;
    width:100%; max-width:520px; text-align:center;
  }
  /* Nav standardmäßig zu */
  header nav{
    width:100%; max-width:520px; margin:0 auto;
    display:block; overflow:hidden; max-height:0;
    transition:max-height .28s ease; border-radius:12px;
    border:1px solid #ffffff14; background:#000a;
  }
  /* Aufgeklappt */
  header.nav-open nav{ max-height:60vh; }
  /* Links im Dropdown – immer einspaltig, keine Zeilenbrüche */
  header nav a, header nav .nav-btn{
    display:block; width:100%; text-align:center;
    padding:12px 14px; border-bottom:1px solid #ffffff14;
    white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  }
  header nav a:last-child, header nav .nav-btn:last-child{ border-bottom:0; }

  /* Nie horizontal scrollen */
  html,body{ overflow-x:hidden; }
}
  </style>
</head>
<body data-page="live">
  <header>
    <img src="logo.png" alt="MJ+ Logo" class="logo">
    <nav aria-label="Main menu">
      <a href="home.html" tabindex="0" data-nav>Home</a>
      <a href="live.html" class="active" tabindex="0">Live</a>
      <a href="tv-appearances.html" tabindex="0" data-nav>TV Appearances</a>
      <a href="interviews.html" tabindex="0" data-nav>Interviews</a>
      <a href="documentaries.html" tabindex="0" data-nav>Documentaries</a>
      <a href="short-films.html" tabindex="0" data-nav>Short Films</a>
      <a href="jacksons.html" tabindex="0" data-nav>The Jacksons</a>
    </nav>
  </header>
  <div class="menu-spacer"></div>

  <!-- Filter-Bar -->
  <div class="filters">
    <button class="filter-btn active" data-filter="all">ALL</button>
    <button class="filter-btn" data-filter="am">AM.</button>
    <button class="filter-btn" data-filter="pro">PRO.</button>
    <button class="filter-btn" data-filter="tours">TOURS</button>
  </div>

  <!-- Normal Grid -->
  <section class="section" id="listSec">
    <h2>All</h2>
    <div id="grid" class="grid"></div>
  </section>

  <!-- Tours View -->
  <section id="toursSec" aria-live="polite">
    <!-- Blöcke werden per JS gerendert -->
  </section>

  <script src="player.js?v=1.0.3"></script>
  <script src="catalog.js?v=1.0.3"></script>
  <script>
    (function(){
      const grid = document.getElementById('grid');
      const listSec = document.getElementById('listSec');
      const toursSec = document.getElementById('toursSec');
      const h2 = listSec.querySelector('h2');
      const buttons = Array.from(document.querySelectorAll('.filter-btn'));

      const specialsForced = new Set([
        'royalbrunei96','mjfriendsmunich99','mjfriendsseoul99','ny01pro','nysept10-01ama'
      ]);

      function liveItems(){
        return (window.catalog || []).filter(x => (x.category==='live' || x.tier));
      }

      function tile(item){
        const b = document.createElement('button');
        b.className='tile'; b.type='button'; b.title=item.title||'';
        b.innerHTML = `
          <img src="${item.poster||''}" alt="${item.title||''}" onerror="this.style.opacity=.2">
          ${item.tier ? `<span class="badge">${item.tier==='am'?'AM.':'PRO'}</span>` : '' }
        `;
        b.addEventListener('click', ()=> window.MJPLUS?.openPoster?.(item,false,'live'));
        b.addEventListener('keydown', (e)=>{ if(['Enter','OK','Select',' '].includes(e.key)){ e.preventDefault(); b.click(); }});
        return b;
      }

      function setActive(val){
        buttons.forEach(b=> b.classList.toggle('active', b.dataset.filter===val));
      }

      function renderList(filter='all'){
        listSec.style.display = '';
        toursSec.style.display = 'none';
        grid.innerHTML = '';
        const items = liveItems();
        let filtered = items;
        if (filter==='am' || filter==='pro'){
          filtered = items.filter(i => (i.tier||'').toLowerCase()===filter);
        }
        h2.textContent = (filter==='all')?'All':filter.toUpperCase();
        filtered.forEach(i => grid.appendChild(tile(i)));
        setTimeout(()=> grid.querySelector('.tile')?.focus(), 40);
      }

      // ---- TOURS view ----
      function getYearFromTitle(t){
        if(!t) return null;
        const m4 = t.match(/(19[7-9]\d|20[0-2]\d)/);
        if (m4) return parseInt(m4[1],10);
        const m2 = t.match(/(^|[\s\-\(\)])([7-9]\d)(?!\d)/);
        if (m2){
          const yy = parseInt(m2[2],10);
          return 1900 + yy;
        }
        return null;
      }

      function tourKey(item){
        if (specialsForced.has(item.id)) return 'special';
        const y = getYearFromTitle(item.title||'') ?? null;
        if (y===1979) return 'destiny';
        if (y===1981) return 'triumph';
        if (y===1984) return 'victory';
        if (y>=1987 && y<=1989) return 'bad';
        if (y===1992 || y===1993) return 'dangerous';
        if (y===1996 || y===1997) return 'history';
        return 'special';
      }

      const tourMeta = {
        destiny:   {title:'Destiny Tour (1979)'},
        triumph:   {title:'Triumph Tour (1981)'},
        victory:   {title:'Victory Tour (1984)'},
        bad:       {title:'Bad Tour (1987–1989)'},
        dangerous: {title:'Dangerous Tour (1992–1993)'},
        history:   {title:'HIStory Tour (1996–1997)'},
        special:   {title:'Special Concerts'}
      };

      function renderTours(){
        listSec.style.display = 'none';
        toursSec.style.display = 'block';
        toursSec.innerHTML = '';
        const groups = {destiny:[],triumph:[],victory:[],bad:[],dangerous:[],history:[],special:[]};
        liveItems().forEach(it => { groups[tourKey(it)].push(it); });

        ['destiny','triumph','victory','bad','dangerous','history','special'].forEach(key=>{
          const arr = groups[key];
          const wrap = document.createElement('div');
          wrap.className = 'tour-block';
          const h = document.createElement('h3');
          h.className = 'tour-title';
          h.textContent = tourMeta[key].title;
          wrap.appendChild(h);
          const g = document.createElement('div');
          g.className = 'grid';
          arr.forEach(it => g.appendChild(tile(it)));
          wrap.appendChild(g);
          toursSec.appendChild(wrap);
        });
        setActive('tours');
      }

      buttons.forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const f = btn.dataset.filter;
          if (f==='tours'){ renderTours(); return; }
          setActive(f);
          renderList(f);
        });
        btn.addEventListener('keydown',(e)=>{ if(['Enter','OK','Select',' '].includes(e.key)){ e.preventDefault(); btn.click(); }});
      });

      renderList('all');
    })();
  </script>
<script src="player.js?v=1.0.3"></script>
<script src="catalog.js?v=1.0.3"></script>
<script src="mobile-menu.js?v=1.0.0"></script>
<script>
  window.MJPLUS?.initHome?.();
  window.MJPLUS?.initSearchUI?.();
</script>
</body>
</html>